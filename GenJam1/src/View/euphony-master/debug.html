<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Eur√≠cides</title>

    <!-- css -->
    <link href="./css/font-awesome.css" rel="stylesheet" />
    <link href="./css/nanoscroller.css" rel="stylesheet" />
    <link href="./css/style.css" rel="stylesheet" />

    <!-- base64 packages -->
    <script src="./lib/MIDI.js/VersionControl.Base64.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/lib/base64binary.js" type="text/javascript"></script>

    <!-- jasmid packages -->
    <script src="./lib/MIDI.js/lib/jasmid/stream.js"></script>
    <script src="./lib/MIDI.js/lib/jasmid/midifile.js"></script>
    <script src="./lib/MIDI.js/lib/jasmid/replayer.js"></script>

    <!-- MIDI.js packages -->
    <script src="./lib/MIDI.js/DOMLoader.XMLHttp.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/DOMLoader.script.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/MIDI.audioDetect.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/MIDI.loadPlugin.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/MIDI.Plugin.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/MIDI.Player.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/Color.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/MusicTheory.js" type="text/javascript"></script>
    <script src="./lib/MIDI.js/MusicTheory.Synesthesia.js" type="text/javascript"></script>

    <script src="./lib/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="./lib/jquery.easing.js" type="text/javascript"></script>
    <script src="./lib/jquery.nanoscroller.min.js" type="text/javascript"></script>
    <script src="./lib/Three.js" type="text/javascript"></script>
    <script src="./lib/state-machine.min.js" type="text/javascript"></script>
    <script src="./lib/spin.min.js" type="text/javascript"></script>
    <script src="./lib/async.min.js" type="text/javascript"></script>

    <!-- main -->
    <script src="./src/compiled/PianoKeyboard.js" type="text/javascript"></script>
    <script src="./src/compiled/NoteRain.js" type="text/javascript"></script>
    <script src="./src/compiled/NoteParticles.js" type="text/javascript"></script>
    <script src="./src/compiled/Scene.js" type="text/javascript"></script>
    <script src="./src/compiled/LoaderWidget.js" type="text/javascript"></script>
    <script src="./src/compiled/PlayerWidget.js" type="text/javascript"></script>
    <script src="./src/compiled/Euphony.js" type="text/javascript"></script>
    <script src="./src/compiled/Main.js" type="text/javascript"></script>
    <script>
        $(document).ready(function(){
            $(".nano").hide();
            $("#validacion").hide();
            $(".player-prev").hide();
            $(".player-next").hide();

            $("#improvisa").click(function(){
                if( ($("#acordes").val() == "") || ($("#tempo").val() == "") ){
                    $("#validacion").show("slow");
                }
                else{
                    $("#validacion").hide("slow");
                    var cadena = $("#acordes").val();
                    cadena = cadena.substr(0,cadena.length - 1);
                    $("#acordes").val(cadena);

                    var arr = $("#acordes").val().split(',');
                    console.log(arr);

                    var enviar = {
                        lista_acordes: arr, 
                        tempo : $("#tempo").val()
                    };

                    var jsonData = JSON.stringify(enviar);
                    
                    console.log(jsonData);
                    
                    $.ajax({
                        type: "POST",
                        data: jsonData,
                        dataType: "json",
                        contentType: "application/json; charset=utf-8",
                        url: "servicios.php",      
                        success: function(data){
                            console.log(data);
                            var archivos = data.split(",");
                            console.log(archivos[0]);
                            //$(location).attr("href", archivos[0]);
                            
                        }
                    });
                }
            
            });
            $(".chord_el").click(function(){
                var cadena = $("#acordes").val();
                cadena += $(this)[0].innerHTML + ",";
                $("#acordes").val(cadena);
            });

            $("#limpiar").click(function(){
                $("#acordes").val("");
            });
        });
    </script>
  </head>
  <body>

    <div id="canvas"></div>

    <div id="player">
      <ul class="player-controls">
        <li class="player-prev" ><i class="icon-step-backward"></i></li>
        <li class="player-play" ><i class="icon-play"></i></li>
        <li class="player-pause" style="display:none;"><i class="icon-pause"></i></li>
        <li class="player-stop" ><i class="icon-stop"></i></li>
        <li class="player-next" ><i class="icon-step-forward"></i></li>
      </ul>


      <!-- Este es el panel bar de al lado -->
      <div class="player-progress-container">
        <div class="player-progress-bar"></div>
        <span class="player-progress-text"></span>
      </div>

      <div class = "genjam" align = "center">
        <br>
        <h4 style="font-family:avenir;">Type your chords</h4>
        <input id = "acordes" size = "54">
        <br>
        <br>
        <span style="font-family:avenir;">Tempo</span>
        <input id = "tempo" value = "180">

        <h5 id = "validacion" style = "color:red;font-family:avenir;">Type your values<h5>
        <input id = "improvisa" type = "button" value = "Play me something!">
        <br>
        <h5 style="font-family:avenir;">Suggested chords</h5>

        <table style="width:200px" align = "center">
            <tr>
              <td class = "chord_el">Cmaj7</td>
              <td class = "chord_el">Dm7</td> 
              <td class = "chord_el">Eb7</td>
            </tr>
            <tr>
              <td class = "chord_el">Fmaj7</td>
              <td class = "chord_el">G7</td> 
              <td class = "chord_el">Am7</td>
            </tr>
            <tr>
              <td class = "chord_el">Bm7b5</td>
              <td class = "chord_el">Gm7</td> 
              <td class = "chord_el">A7</td>
            </tr>
            <tr>
              <td class = "chord_el">D7</td>
              <td class = "chord_el">Em7</td> 
              <td class = "chord_el">E7</td>
            </tr>
        </table>
        <br>
        <input id = "limpiar" type = "button" value = "Clean me!">

      </div>
      <!-- Fin del panel bar de al lado-->

      <ul class="player-playlist-container nano">
        <div class="content">
          <ul class="player-playlist"></ul>
        </div>
      </ul>
    </div>


    <footer id="about">
      
      Drag &amp; drop your MIDI files to play
    </footer>

  </body>
</html>
